(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-29fd"],{"+5nK":function(e,t,i){"use strict";var n=i("ydUZ");i.n(n).a},"+iuc":function(e,t,i){i("wgeU"),i("FlQf"),i("bBy9"),i("B9jh"),i("dL40"),i("xvv9"),i("V+O7"),e.exports=i("WEpk").Set},"/Y58":function(e,t,i){},"1y+I":function(e,t,i){"use strict";var n=i("YAll");i.n(n).a},"2Kw3":function(e,t,i){},"3Nrr":function(e,t,i){"use strict";var n=i("OPQh");i.n(n).a},"3Pm4":function(e,t,i){"use strict";var n=i("6bD/");i.n(n).a},"4R/5":function(e,t,i){},"5jDI":function(e,t,i){"use strict";i.r(t);var n=i("EJiy"),l=i.n(n),a=i("QbLZ"),s=i.n(a),o=i("6iAj"),r=i("4XAY"),c=i("a/5N"),d={name:"FieldWrapper",props:{field:{type:Object,required:!0},activate:{type:Boolean,default:!1},controlFlag:{type:Object,default:function(){return{top:!1,bottom:!1,left:!1,right:!1,delete:!1,copy:!0}}},hiddenTitle:{type:Boolean,default:!1}},computed:{fieldWidth:function(){return this.field?this.field.stylePercent+"%":"100%"}},watch:{field:{handler:function(){this.field&&!this.field.stylePercent&&(this.field.stylePercent=100)},deep:!0,immediate:!0}},methods:{emitClick:function(e){this.$emit("click",e)},handleControl:function(e,t){this.$emit("action",e,t)}}},u=(i("A8OQ"),i("KHd+")),f=Object(u.a)(d,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"field-item",class:{activate:e.activate},style:{width:e.fieldWidth},on:{click:function(t){return t.stopPropagation(),e.emitClick(t)}}},[e.hiddenTitle?e._e():i("div",{staticClass:"field-item_title"},[i("span",{staticClass:"required"},[e._v(e._s(e.field.isNull?"*":""))]),e._v(" "),i("span",[e._v(e._s(e.field.name))]),e._v(" "),e.field.inputTips?i("span",{staticClass:"input-tips"},[e._v("\n      （"+e._s(e.field.inputTips)+"）\n    ")]):e._e()]),e._v(" "),i("div",{staticClass:"field-item_body"},[e._t("default")],2),e._v(" "),e.activate?[e.controlFlag.top?i("div",{staticClass:"control-top control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("top",t)}}},[i("i",{staticClass:"wk wk-icon-top"})]):e._e(),e._v(" "),e.controlFlag.bottom?i("div",{staticClass:"control-bottom control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("bottom",t)}}},[i("i",{staticClass:"wk wk-icon-top bottom"})]):e._e(),e._v(" "),e.controlFlag.left?i("div",{staticClass:"control-left control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("left",t)}}},[i("i",{staticClass:"wk wk-transfer"})]):e._e(),e._v(" "),e.controlFlag.right?i("div",{staticClass:"control-right control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("right",t)}}},[i("i",{staticClass:"wk wk-transfer"})]):e._e(),e._v(" "),i("div",{staticClass:"edit-box"},[e.controlFlag.copy?i("div",{staticClass:"control-copy control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("copy",t)}}},[i("i",{staticClass:"wk wk-associated"})]):e._e(),e._v(" "),e.controlFlag.delete?i("div",{staticClass:"control-delete control-btn",on:{click:function(t){t.stopPropagation(),e.handleControl("delete",t)}}},[i("i",{staticClass:"wk wk-s-delete"})]):e._e()])]:e._e()],2)},[],!1,null,"864d490a",null);f.options.__file="FieldWrapper.vue";var p=f.exports;function h(e){var t=e.toString(2).padStart(8,"0");return{nameEdit:Boolean(Number(t.charAt(0))),deleteEdit:Boolean(Number(t.charAt(1))),defaultEdit:Boolean(Number(t.charAt(2))),percentEdit:Boolean(Number(t.charAt(3))),nullEdit:Boolean(Number(t.charAt(4))),uniqueEdit:Boolean(Number(t.charAt(5))),hiddenEdit:Boolean(Number(t.charAt(6))),optionsEdit:Boolean(Number(t.charAt(7)))}}var m={props:{field:{type:Object,required:!0},fieldArr:{type:Array,required:!0},point:{type:Array},activePoint:{type:Array,default:[]}},data:function(){return{specialFormType:["detail_table"]}},computed:{activate:function(){return this.point[0]===this.activePoint[0]&&this.point[1]===this.activePoint[1]},disabled:function(){return!this.fieldAuth.defaultEdit},fieldAuth:function(){return h(this.field.operating)},topFlag:function(){var e=this.point[0];if(0===e)return!1;var t=this.fieldArr[e-1];return 4!==t.length&&!this.specialFormType.includes(t[0].formType)},bottomFlag:function(){var e=this.point[0];return e!==this.fieldArr.length-1&&!(this.fieldArr[e].length<=1)},leftFlag:function(){return 0!==this.point[1]},rightFlag:function(){var e=this.point[1],t=this.point[0];return e!==this.fieldArr[t].length-1},controlFlag:function(){return{top:this.topFlag,bottom:this.bottomFlag,left:this.leftFlag,right:this.rightFlag,delete:this.fieldAuth.deleteEdit,copy:!["customer","business","contacts","contract","receivables_plan","single_user"].includes(this.field.formType)}}},methods:{emitClick:function(e){this.$emit("click",e)},handleAction:function(e,t){this.$emit("action",e,this.point,t)}}},v={name:"FieldInput",components:{FieldWrapper:p},mixins:[m],methods:{}},b=(i("+5nK"),Object(u.a)(v,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-input",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("flexbox",{staticClass:"box",attrs:{align:"center"}},[i("span",{staticClass:"default-val"},[e._v("\n      "+e._s("string"==typeof e.field.defaultValue?e.field.defaultValue:"")+"\n    ")])])],1)},[],!1,null,"e78a16c4",null));b.options.__file="FieldInput.vue";var _=b.exports,g={name:"FieldTextarea",components:{FieldWrapper:p},mixins:[m],methods:{}},y=(i("gLsL"),Object(u.a)(g,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-textarea",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("div",{staticClass:"box"},[i("div",{staticClass:"default-val"},[e._v("\n      "+e._s("string"==typeof e.field.defaultValue?e.field.defaultValue:"")+"\n    ")]),e._v(" "),i("div",{staticClass:"max-tips"},[e._v("\n      "+e._s(e.field.defaultValue.length+"/"+e.field.maxLength)+"\n    ")])])])},[],!1,null,"66ac7060",null));y.options.__file="FieldTextarea.vue";var x=y.exports,k={name:"FieldSelect",components:{FieldWrapper:p},mixins:[m],methods:{}},C=(i("xU3P"),Object(u.a)(k,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-select",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("flexbox",{staticClass:"select-box"},[i("div",{class:{placeholder:!Boolean(e.field.defaultValue)}},[e._v("\n      "+e._s(e.field.defaultValue?e.field.defaultValue:"请选择")+"\n    ")]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1)},[],!1,null,"2e04fe5c",null));C.options.__file="FieldSelect.vue";var F=C.exports,w={name:"FieldCheckbox",components:{FieldWrapper:p},mixins:[m],methods:{}},T=(i("QCIG"),Object(u.a)(w,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-checkbox",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("el-checkbox-group",{attrs:{disabled:e.disabled},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}},e._l(e.field.setting,function(e,t){return i("el-checkbox",{key:t,staticClass:"checkbox",attrs:{label:e}})}))],1)},[],!1,null,"876e2eae",null));T.options.__file="FieldCheckbox.vue";var N=T.exports,A={name:"FieldFile",components:{FieldWrapper:p},mixins:[m],methods:{}},V=(i("Z5jk"),Object(u.a)(A,function(){var e=this.$createElement,t=this._self._c||e;return t("field-wrapper",{staticClass:"field-file",attrs:{activate:this.activate,field:this.field,"control-flag":this.controlFlag},on:{click:this.emitClick,action:this.handleAction}},[t("div",{staticClass:"box"},[this._v("\n    请选择文件\n  ")])])},[],!1,null,"3ff99cb6",null));V.options.__file="FieldFile.vue";var j=V.exports,O={name:"FieldBoolean",components:{FieldWrapper:p},mixins:[m],methods:{}},E=(i("3Nrr"),Object(u.a)(O,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-boolean",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}})],1)},[],!1,null,"3d9f273b",null));E.options.__file="FieldBoolean.vue";var P=E.exports,$={name:"FieldPercent",components:{FieldWrapper:p},mixins:[m],methods:{}},S=(i("3Pm4"),Object(u.a)($,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-percent",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("div",{staticClass:"box"},[i("span",{staticClass:"default-val"},[e._v(e._s(e.field.defaultValue||""))]),e._v(" "),i("span",{staticClass:"rate"},[e._v("%")])])])},[],!1,null,"430ed38a",null));S.options.__file="FieldPercent.vue";var L=S.exports,R={name:"FieldPosition",components:{FieldWrapper:p},mixins:[m],computed:{areaText:function(){return Object(c.b)(this.field.defaultValue)?"":this.field.defaultValue.filter(function(e){return 4!==e.id}).map(function(e){return e.name}).join("/")},detailAddress:function(){if(Object(c.b)(this.field.defaultValue))return"";var e=this.field.defaultValue.find(function(e){return 4===e.id});return e?e.name:""}},methods:{}},D=(i("dydj"),Object(u.a)(R,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-map-position",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("flexbox",{staticClass:"box-select"},[i("div",{class:{placeholder:!Boolean(e.areaText)}},[e._v("\n      "+e._s(e.areaText||"请选择")+"\n    ")]),e._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),1===e.field.precisions?i("div",{staticClass:"box-textarea"},[i("div",{class:{placeholder:!Boolean(e.detailAddress)}},[e._v("\n      "+e._s(e.detailAddress||"详细地址")+"\n    ")])]):e._e()],1)},[],!1,null,"1adc2840",null));D.options.__file="FieldPosition.vue";var I=D.exports,W={name:"FieldCurrentPosition",components:{FieldWrapper:p},mixins:[m],methods:{}},M=(i("nZ08"),Object(u.a)(W,function(){var e=this.$createElement,t=this._self._c||e;return t("field-wrapper",{staticClass:"field-current-position",attrs:{activate:this.activate,field:this.field,"control-flag":this.controlFlag},on:{click:this.emitClick,action:this.handleAction}},[t("flexbox",{staticClass:"box",attrs:{align:"center"}},[t("flexbox-item",{staticClass:"default-val"}),this._v(" "),t("span",{staticClass:"wk wk-icon-location"})],1)],1)},[],!1,null,"d94f4fca",null));M.options.__file="FieldLocation.vue";var B=M.exports,U={name:"FieldDetailTable",components:{FieldWrapper:p},mixins:[m],methods:{}},q=(i("unMc"),Object(u.a)(U,function(){var e=this.$createElement,t=this._self._c||e;return t("field-wrapper",{staticClass:"field-detail-table",attrs:{activate:this.activate,field:this.field,"control-flag":this.controlFlag},on:{click:this.emitClick,action:this.handleAction}},[t("div",{staticClass:"box"},[this._v("\n    明细表格\n  ")])])},[],!1,null,"1603d0fe",null));q.options.__file="FieldDetailTable.vue";var H=q.exports,z={name:"FieldWritingSign",components:{FieldWrapper:p},mixins:[m],methods:{}},Q=(i("Ozf1"),Object(u.a)(z,function(){var e=this.$createElement,t=this._self._c||e;return t("field-wrapper",{staticClass:"field-writing-sign",attrs:{activate:this.activate,field:this.field,"control-flag":this.controlFlag},on:{click:this.emitClick,action:this.handleAction}},[t("div",{staticClass:"box"})])},[],!1,null,"5fff7668",null));Q.options.__file="FieldWritingSign.vue";var K=Q.exports,Y={name:"FieldDateInterval",components:{FieldWrapper:p},mixins:[m],methods:{}},Z=(i("OzhN"),Object(u.a)(Y,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("field-wrapper",{staticClass:"field-date-interval",attrs:{activate:e.activate,field:e.field,"control-flag":e.controlFlag},on:{click:e.emitClick,action:e.handleAction}},[i("flexbox",{staticClass:"range-box"},[i("i",{staticClass:"el-icon-date icon"}),e._v(" "),i("flexbox-item",{class:{placeholder:!Boolean(e.field.defaultValue)}},[e._v("\n      "+e._s(e.field.defaultValue[0]||"开始时间")+"\n    ")]),e._v(" "),i("span",[e._v("至")]),e._v(" "),i("flexbox-item",{class:{placeholder:!Boolean(e.field.defaultValue)}},[e._v("\n      "+e._s(e.field.defaultValue[1]||"结束时间")+"\n    ")])],1)],1)},[],!1,null,"72466008",null));Z.options.__file="FieldDateInterval.vue";var G=Z.exports,J=i("glbJ"),X={name:"FieldDescText",components:{FieldWrapper:p,Tinymce:J.a},mixins:[m],methods:{}},ee=(i("KD76"),i("QgEU"),Object(u.a)(X,function(){var e=this.$createElement,t=this._self._c||e;return t("field-wrapper",{staticClass:"field-desc-text",attrs:{activate:this.activate,field:this.field,"control-flag":this.controlFlag,"hidden-title":""},on:{click:this.emitClick,action:this.handleAction}},[t("tinymce",{staticClass:"rich-txt",attrs:{value:this.field.defaultValue,disabled:1,toolbar:[],init:{menubar:!1,toolbar_sticky:!0,statusbar:!1,placeholder:"描述文字内容",quickbars_selection_toolbar:!1,contextmenu:"",content_style:" * {color: #262626; margin: 0;} body { font-size: 14px; }",plugins:"autoresize",autoresize_bottom_margin:0}}}),this._v(" "),t("div",{staticClass:"field-desc-text-cover"})],1)},[],!1,null,"e11acc28",null));ee.options.__file="FieldDescText.vue";var te=ee.exports,ie=i("UEfr"),ne=i("7Qib"),le={name:"SettingDefault",components:{WkDistpicker:ie.a},props:{field:{type:Object,required:!0}},data:function(){return{selectedMapValue:[],detailAddress:"",oldPrecisions:null,areaData:[]}},computed:{disabled:function(){return!h(this.field.operating).defaultEdit},canClearable:function(){var e=this.field.formType;return!["boolean_value"].includes(e)},type:function(){var e=this.field.formType;if(["date","datetime"].includes(e))return"datePicker";if(["number","floatnumber","percent"].includes(e))return"number";if(["select","checkbox","boolean_value"].includes(e))return"select";switch(this.field.formType){case"date_interval":return"date_interval";case"position":return"position";default:return"text"}},options:function(){if("select"!==this.type)return[];var e=this.field.formType;if(["select","checkbox"].includes(e))return this.field.setting.map(function(e){return{label:e,value:e}});switch(e){case"boolean_value":return[{label:"选中",value:"1"},{label:"不选中",value:"0"}];default:return[]}}},watch:{field:{handler:function(){if("boolean_value"!==this.field.formType){if("select"===this.type&&Object(c.b)(this.field.setting)&&!Object(c.b)(this.field.options)&&this.$set(this.field,"setting",this.field.options.split(",")),"position"===this.type)if(this.resetDefaultValue(),Object(c.b)(this.field.defaultValue))this.selectedMapValue=[],Object(c.a)(this.field.defaultValue)||(this.field.defaultValue=[]),this.detailAddress="";else if(this.selectedMapValue=this.field.defaultValue.filter(function(e){return 4!==e.id}),1===this.field.precisions){var e=this.field.defaultValue.find(function(e){return 4===e.id});this.detailAddress=e?e.name:""}}else this.field.defaultValue=Object(c.b)(this.field.defaultValue)?"0":this.field.defaultValue},deep:!0,immediate:!0}},methods:{inputBlur:function(){if(this.field.defaultValue)if("mobile"===this.field.formType)Object(ne.v)(this.field.defaultValue)||(this.$message.error("输入的手机格式有误"),this.field.defaultValue="");else if("email"===this.field.formType)Object(ne.u)(this.field.defaultValue)||(this.$message.error("输入的邮箱格式有误"),this.field.defaultValue="");else if("number"===this.type){var e=Number(this.field.defaultValue);if(isNaN(e))return void(this.field.defaultValue=null);this.field.defaultValue=String(e);var t=String(e).split("."),i=String(e).replace(".","").replace("-","").length,n="percent"===this.field.formType?10:15;if(i>n)return this.$message.error("最多支持"+n+"位数字（包含小数位）"),void(this.field.defaultValue=null);var l=Object(c.b)(this.field.minNumRestrict)?-1/0:Number(this.field.minNumRestrict||-1/0),a=Object(c.b)(this.field.maxNumRestrict)?1/0:Number(this.field.maxNumRestrict||1/0);if(e<l)return this.$message.error("默认值不能小于最小值"),void(this.field.defaultValue=null);if(e>a)return this.$message.error("默认值不能大于最大值"),void(this.field.defaultValue=null);if(Object(c.b)(this.field.precisions))return void(this.field.defaultValue=t[0]);if(0===this.field.precisions)return;t.length>1&&t[1].length>Number(this.field.precisions)&&(this.$message.error("默认值的小数位不能大于"+this.field.precisions),this.field.defaultValue=null)}},resetDefaultValue:function(){this.oldPrecisions&&this.oldPrecisions!==this.field.precisions?(this.oldPrecisions=this.field.precisions,this.selectedMapValue=[],Object(c.b)(this.field.defaultValue)||(this.field.defaultValue=[])):this.oldPrecisions=this.field.precisions},inputPositionChange:function(){if(1!==this.field.precisions){var e=this.field.defaultValue.findIndex(function(e){return 4===e.id});if(-1===e)return;this.field.defaultValue.splice(e,1)}else{var t=this.field.defaultValue.find(function(e){return 4===e.id});t?t.name=this.detailAddress:this.field.defaultValue.push({code:"",name:this.detailAddress,id:4})}},handleCascaderChange:function(){this.field.defaultValue=this.selectedMapValue,this.inputPositionChange()},getCascaderValArr:function(e,t){var i=[];if(0===t.length)return i;var n=0,l=Object(ne.t)(e);do{var a=l.find(function(e){return e.code===t[n]});a&&(l=a.children||[],i.push({code:a.code,name:a.name,id:n+1})),n++}while(n<=t.length);return i}}},ae=(i("bHGY"),Object(u.a)(le,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setting-default"},["text"===e.type?i("el-input",{attrs:{disabled:e.disabled},on:{blur:e.inputBlur},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}}):"datePicker"===e.type?i("el-date-picker",{attrs:{disabled:e.disabled,type:"date"===e.field.formType?"date":"datetime","value-format":"date"===e.field.formType?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择"},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}}):"date_interval"===e.type?i("el-date-picker",{attrs:{type:1===e.field.precisions?"daterange":"datetimerange","value-format":1===e.field.precisions?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",disabled:e.disabled,"start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}}):"select"===e.type?i("el-select",{attrs:{clearable:e.canClearable,multiple:"checkbox"===e.field.formType,disabled:e.disabled,placeholder:"请选择"},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}},e._l(e.options,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})):"number"===e.type?[i("el-input",{attrs:{disabled:e.disabled},on:{blur:e.inputBlur},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}},["percent"===e.field.formType?i("div",{staticClass:"el-input__icon",attrs:{slot:"suffix"},slot:"suffix"},[e._v("%")]):e._e()]),e._v(" "),i("div",{staticClass:"input-tips"},[i("span",[e._v("*")]),e._v("\n      数字的位数必须少于"+e._s("percent"===e.field.formType?10:15)+"位\n    ")])]:"position"===e.type?[i("wk-distpicker",{attrs:{"hide-area":e.field.precisions>=3,"only-province":4===e.field.precisions,disabled:e.disabled,clearable:""},on:{change:e.handleCascaderChange},model:{value:e.selectedMapValue,callback:function(t){e.selectedMapValue=t},expression:"selectedMapValue"}}),e._v(" "),1===e.field.precisions?i("el-input",{staticStyle:{"margin-top":"5px"},attrs:{rows:3,maxlength:100,disabled:e.disabled,type:"textarea"},on:{change:e.inputPositionChange},model:{value:e.detailAddress,callback:function(t){e.detailAddress=t},expression:"detailAddress"}}):e._e()]:e._e()],2)},[],!1,null,"4378af4e",null));ae.options.__file="SettingDefault.vue";var se=ae.exports,oe=i("jWXv"),re=i.n(oe),ce=i("rfXi"),de=i.n(ce),ue=i("t2rG"),fe=i.n(ue),pe={name:"SettingOptions",components:{draggable:fe.a},props:{field:{type:Object,required:!0}},data:function(){return{optionsList:[]}},computed:{optionsEditAuth:function(){return h(this.field.operating).optionsEdit},dragConfig:function(){return{group:"list",forceFallback:!1,disabled:!this.optionsEditAuth,fallbackClass:"draggingStyle",handle:".drag-hook",filter:".el-input__inner",preventOnFilter:!1}}},watch:{field:{handler:function(e,t){Object(c.b)(this.field.options)&&this.$set(this.field,"options","选1,选2,选3"),t&&e.options===t.options||(this.optionsList=this.field.options.split(",").map(function(e){return{value:e}}))},deep:!0,immediate:!0}},methods:{handleChange:function(){var e=this,t=this.optionsList.map(function(e){return e.value}).filter(function(e){return!Object(c.b)(e)});(t=de()(new re.a(t))).length!==this.optionsList.length&&(this.optionsList=t.map(function(e){return{value:e}})),this.field.setting=t,this.field.options=t.join(","),this.$set(this.field,"setting",this.field.setting),this.$set(this.field,"options",this.field.options),this.$nextTick(function(){e.checkDefaultValue()})},handleDelete:function(e){this.optionsList.splice(e,1),this.field.setting.splice(e,1),this.$set(this.field,"setting",this.field.setting),this.$set(this.field,"options",this.field.setting.join(",")),this.checkDefaultValue()},handleAdd:function(){var e=this.getAddValue(this.optionsList.length+1);this.optionsList.push({value:e}),this.handleChange()},getAddValue:function(e){return this.optionsList.find(function(t){return t.value==="选"+e})?this.getAddValue(e+1):"选"+e},checkDefaultValue:function(){var e=this;if(!Object(c.b)(this.field.defaultValue))if(Object(c.a)(this.field.defaultValue)){var t=[];this.field.defaultValue.forEach(function(i){e.optionsList.find(function(e){return e.value===i})&&t.push(i)}),this.$set(this.field,"defaultValue",[].concat(t))}else{this.optionsList.find(function(t){return t.value===e.field.defaultValue})||this.$set(this.field,"defaultValue",null)}}}},he=(i("u73G"),Object(u.a)(pe,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setting-options"},[i("draggable",{attrs:{list:e.optionsList,options:e.dragConfig},on:{sort:e.handleChange}},e._l(e.optionsList,function(t,n){return i("div",{key:n,staticClass:"option-item"},[i("el-input",{attrs:{disabled:!e.optionsEditAuth},on:{change:e.handleChange},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}},[e.optionsEditAuth?i("flexbox",{attrs:{slot:"suffix"},slot:"suffix"},[i("div",{staticClass:"el-input__icon drag-hook wk wk-grid"}),e._v(" "),i("el-button",{staticClass:"el-input__icon wk wk-icon-bin",attrs:{type:"text"},on:{click:function(t){e.handleDelete(n)}}})],1):e._e()],1)],1)})),e._v(" "),e.optionsEditAuth?i("el-button",{staticClass:"add-btn",on:{click:e.handleAdd}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加新选项\n  ")]):e._e()],1)},[],!1,null,"65b89702",null));he.options.__file="SettingOptions.vue";var me=he.exports,ve={name:"SettingNumber",props:{field:{type:Object,required:!0}},data:function(){return{checked:!1,precisionList:[],limitChecked:!1,minNumRestrict:void 0,maxNumRestrict:void 0}},watch:{field:{handler:function(){if(["number","floatnumber","percent"].includes(this.field.formType)){this.field.hasOwnProperty("minNumRestrict")||(this.field.minNumRestrict=null),this.field.hasOwnProperty("maxNumRestrict")||(this.field.maxNumRestrict=null),this.minNumRestrict=Object(c.b)(this.field.minNumRestrict)?void 0:Number(this.field.minNumRestrict),this.maxNumRestrict=Object(c.b)(this.field.maxNumRestrict)?void 0:Number(this.field.maxNumRestrict);var e="percent"===this.field.formType?5:14;this.precisionList=de()({length:e}).map(function(e,t){return{label:t+1,value:t+1}}),this.field.hasOwnProperty("precisions")||(this.field.precisions="number"===this.field.formType?4:2),this.field.precisions>e&&(this.field.precisions=e),this.checked=!Object(c.b)(this.field.precisions),this.limitChecked=!Object(c.b)(this.minNumRestrict)||!Object(c.b)(this.maxNumRestrict)}},deep:!0,immediate:!0}},methods:{checkedChange:function(){this.checked?this.field.precisions=2:this.field.precisions=null},handleSelectChange:function(){this.$set(this.field,"precisions",this.field.precisions),this.$forceUpdate()},limitChange:function(){this.limitChecked||(this.minNumRestrict=void 0,this.maxNumRestrict=void 0,this.field.minNumRestrict="",this.field.maxNumRestrict="")},handleChangeNumber:function(e){var t=this[e],i=String(t||"").replace(".","").replace("-","").length,n="percent"===this.field.formType?10:15;if(i>n)return this.$message.error("最多支持"+n+"位数字"),void(this.field[e]=null);var l=this.minNumRestrict,a=this.maxNumRestrict;Object(c.b)(l)||Object(c.b)(a)||Number(l)>Number(a)&&(this.$message.error("请输入正确的数值范围"),this.field[e]=null);var s=Object(c.b)(l)?"":l,o=Object(c.b)(a)?"":a;this.field.minNumRestrict=null!==this.minNumRestrict?String(s):null,this.field.maxNumRestrict=null!==this.maxNumRestrict?String(o):null}}},be=(i("K8Hv"),i("1y+I"),Object(u.a)(ve,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setting-number"},[i("flexbox",{staticClass:"setting-number-item",attrs:{align:"center",justify:"flex-start"}},[i("el-checkbox",{on:{change:e.checkedChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._v(" "),i("span",{staticStyle:{"font-size":"13px"}},[e._v("支持小数")]),e._v(" "),i("el-tooltip",{attrs:{content:"不选择只能输入整数，勾选后可规定小数位数",effect:"dark","popper-class":"setting-number-tooltip",placement:"top"}},[i("i",{staticClass:"wk wk-help wk-help-tips"})]),e._v(" "),e.checked?[i("span",[e._v("限制 ")]),e._v(" "),i("el-select",{attrs:{size:"small",placeholder:""},on:{change:e.handleSelectChange},model:{value:e.field.precisions,callback:function(t){e.$set(e.field,"precisions",t)},expression:"field.precisions"}},e._l(e.precisionList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),i("span",[e._v(" 位")])]:e._e()],2),e._v(" "),i("flexbox",{staticClass:"setting-number-item",attrs:{align:"flex-start",justify:"flex-start",direction:"column"}},[i("el-checkbox",{on:{change:e.limitChange},model:{value:e.limitChecked,callback:function(t){e.limitChecked=t},expression:"limitChecked"}},[e._v("\n      限制数值范围\n    ")]),e._v(" "),e.limitChecked?i("flexbox",{staticClass:"number-range-body",attrs:{align:"center",justify:"flex-start"}},[i("flexbox-item",[i("el-input-number",{attrs:{controls:!1,placeholder:"最小值"},on:{change:function(t){e.handleChangeNumber("minNumRestrict")}},model:{value:e.minNumRestrict,callback:function(t){e.minNumRestrict=t},expression:"minNumRestrict"}})],1),e._v(" "),i("div",{staticClass:"number-range-text"},[e._v("~")]),e._v(" "),i("flexbox-item",[i("el-input-number",{attrs:{controls:!1,placeholder:"最大值"},on:{change:function(t){e.handleChangeNumber("maxNumRestrict")}},model:{value:e.maxNumRestrict,callback:function(t){e.maxNumRestrict=t},expression:"maxNumRestrict"}})],1)],1):e._e()],1)],1)},[],!1,null,"0cfe1ee6",null));be.options.__file="SettingNumber.vue";var _e=be.exports,ge={name:"SettingPrecisions",props:{field:{type:Object,required:!0}},data:function(){return{options:[]}},watch:{field:{handler:function(){["date_interval","position"].includes(this.field.formType)&&("date_interval"===this.field.formType?this.options=[{label:"日期",value:1},{label:"日期时间",value:2}]:"position"===this.field.formType&&(this.options=[{label:"省/地区、市、区/县、详细地址",value:1},{label:"省/地区、市、区/县",value:2},{label:"省/地区、市",value:3},{label:"省/地区",value:4}]),this.field.precisions||this.$set(this.field,"precisions",1))},deep:!0,immediate:!0}}},ye=(i("kCQN"),Object(u.a)(ge,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setting-precisions"},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.field.precisions,callback:function(t){e.$set(e.field,"precisions",t)},expression:"field.precisions"}},e._l(e.options,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)},[],!1,null,"5e2611ca",null));ye.options.__file="SettingPrecisions.vue";var xe=ye.exports,ke=i("ehos"),Ce={name:"SettingRichText",components:{Tinymce:J.a},props:{field:{type:Object,required:!0}},data:function(){return{debouncedEditorInput:null}},created:function(){this.debouncedEditorInput=Object(ke.debounce)(300,this.editInputChange)},methods:{getEditConfig:function(){return{menubar:!1,statusbar:!1,paste_data_images:!0,paste_enable_default_filters:!1,placeholder:"描述文字内容",content_style:" * {color: #262626; margin: 0;} body { margin: 8px; font-size: 14px; }",paste_retain_style_properties:"border",toolbar_mode:"scrolling",paste_preprocess:function(e,t){["b","strong","i","em"].forEach(function(e){var i=new RegExp("(<"+e+">)|(</"+e+">)]","g");t.content=t.content.replace(i,"")});["h1","h2","h3","h4","h5","h6"].forEach(function(e){var i=new RegExp("<"+e+">","g"),n=new RegExp("</"+e+">","g");t.content=t.content.replace(i,"<p>"),t.content=t.content.replace(n,"</p>")}),t.content=t.content.replace(/<\/font>/gi,"").replace(/<font[^>]+>/gi,"")},paste_postprocess:function(e,t){de()(t.node.querySelectorAll("*")).forEach(function(e){e.style.color="",e.style.fontWeight="",e.style.fontFamily="",e.style.fontSize="",e.style.background=""})}}},editInputChange:function(){}}},Fe=(i("kurV"),Object(u.a)(Ce,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"setting-rich-text"},[i("tinymce",{ref:"createTinymce",staticClass:"rich-txt",attrs:{init:e.getEditConfig(),height:200,toolbar:"bold italic underline strikethrough | fontselect | forecolor backcolor | fontsizeselect | numlist bullist | alignleft aligncenter alignright | image link | removeformat"},on:{input:e.debouncedEditorInput},model:{value:e.field.defaultValue,callback:function(t){e.$set(e.field,"defaultValue",t)},expression:"field.defaultValue"}})],1)},[],!1,null,"9604d066",null));Fe.options.__file="SettingDescText.vue";var we=[{componentName:"FieldInput",formType:"text",name:"单行文本",type:1,icon:"wk wk-icon-text"},{componentName:"FieldTextarea",formType:"textarea",name:"多行文本",type:2,icon:"wk wk-icon-textarea"},{componentName:"FieldInput",formType:"website",name:"网址",type:25,icon:"wk wk-icon-website"},{componentName:"FieldBoolean",formType:"boolean_value",name:"布尔值",type:41,icon:"wk wk-icon-bool"},{componentName:"FieldSelect",formType:"select",name:"下拉框",type:3,icon:"wk wk-icon-select"},{componentName:"FieldCheckbox",formType:"checkbox",name:"多选",type:9,icon:"wk wk-icon-checkbox"},{componentName:"FieldInput",formType:"number",name:"数字",type:5,icon:"wk wk-icon-int"},{componentName:"FieldInput",formType:"floatnumber",name:"货币",type:6,icon:"wk wk-icon-coin"},{componentName:"FieldPercent",formType:"percent",name:"百分数",type:42,icon:"wk wk-icon-percent"},{componentName:"FieldInput",formType:"mobile",name:"手机",type:7,icon:"wk wk-icon-mobile"},{componentName:"FieldInput",formType:"email",name:"邮箱",type:14,icon:"wk wk-icon-email"},{componentName:"FieldInput",formType:"date",name:"日期",type:4,icon:"wk wk-icon-date"},{componentName:"FieldInput",formType:"datetime",name:"日期时间",type:13,icon:"wk wk-icon-datetime"},{componentName:"FieldDateInterval",formType:"date_interval",name:"日期区间",type:48,icon:"wk wk-icon-range"},{componentName:"FieldPosition",formType:"position",name:"地址",type:43,icon:"wk wk-icon-address"},{componentName:"FieldLocation",formType:"location",name:"定位",type:44,icon:"wk wk-icon-nav"},{componentName:"FieldInput",formType:"user",name:"人员",type:10,icon:"wk wk-icon-user-data"},{componentName:"FieldInput",formType:"structure",name:"部门",type:12,icon:"wk wk-icon-users"},{componentName:"FieldFile",formType:"file",name:"附件",type:8,icon:"wk wk-icon-file"},{componentName:"FieldWritingSign",formType:"handwriting_sign",name:"手写签名",type:46,icon:"wk wk-icon-signature"},{componentName:"FieldDescText",formType:"desc_text",name:"描述文字",type:50,icon:"wk wk-icon-des"}],Te={name:"FieldSetting",components:{SettingDefault:se,SettingOptions:me,SettingNumber:_e,SettingPrecisions:xe,SettingDescText:Fe.exports},props:{canTransform:Boolean,canUnique:{type:Boolean,default:!0},transformData:Object,field:{type:Object,required:!0}},data:function(){return{widthOptions:[{value:25},{value:50},{value:75},{value:100}],stylePercentValue:[]}},computed:{typeObj:function(){var e=this;return we.find(function(t){return t.formType===e.field.formType})||this.field},fieldAuth:function(){return h(this.field.operating)},canDefault:function(){return!["user","structure","file","location","handwriting_sign"].includes(this.field.formType)},canOptions:function(){return["select","checkbox"].includes(this.field.formType)},canNumber:function(){return["number","floatnumber","percent"].includes(this.field.formType)},canPrecisions:function(){return["date_interval","position"].includes(this.field.formType)},canDescText:function(){return"desc_text"===this.field.formType},showHidden:function(){return"oa_examine"!==this.$route.params.type}},watch:{field:{handler:function(){this.stylePercentValue=[Number(this.field.stylePercent)||100]},deep:!0,immediate:!0}},methods:{emitUpdateWidth:function(){this.$emit("update-width")}}},Ne=(i("RjCt"),Object(u.a)(Te,function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.typeObj?i("div",{staticClass:"field-setting"},[i("div",{staticClass:"setting-title"},[e._v("\n    "+e._s(e.typeObj.name)+"\n  ")]),e._v(" "),i("div",{staticClass:"setting-body"},[e.canDescText?e._e():[i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("标识名")]),e._v(" "),i("el-input",{attrs:{disabled:!e.fieldAuth.nameEdit},model:{value:e.field.name,callback:function(t){e.$set(e.field,"name",t)},expression:"field.name"}}),e._v(" "),e._m(0)],1),e._v(" "),i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("提示文字")]),e._v(" "),i("el-input",{attrs:{rows:3,type:"textarea",resize:"none"},model:{value:e.field.inputTips,callback:function(t){e.$set(e.field,"inputTips",t)},expression:"field.inputTips"}}),e._v(" "),e._m(1)],1),e._v(" "),e.canOptions?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("选项内容")]),e._v(" "),i("setting-options",{attrs:{field:e.field}})],1):e._e(),e._v(" "),e.canPrecisions?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("\n          "+e._s("date_interval"===e.field.formType?"日期类型":"地址精度")+"\n        ")]),e._v(" "),i("setting-precisions",{attrs:{field:e.field}})],1):e._e(),e._v(" "),e.canDefault?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("默认值")]),e._v(" "),i("setting-default",{attrs:{field:e.field}})],1):e._e(),e._v(" "),e.canNumber?i("div",{staticClass:"item-section"},[i("setting-number",{attrs:{field:e.field}})],1):e._e()],e._v(" "),e.canDescText?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("内容")]),e._v(" "),i("setting-desc-text",{attrs:{field:e.field}})],1):e._e(),e._v(" "),e.fieldAuth.percentEdit?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("\n        字段占比 %\n        "),i("el-tooltip",{attrs:{content:"配置表单布局，可以单行多字段排布",effect:"dark",placement:"top"}},[i("i",{staticClass:"wk wk-help wk-help-tips",staticStyle:{"margin-left":"3px"}})])],1),e._v(" "),i("el-radio-group",{attrs:{size:"medium"},on:{change:e.emitUpdateWidth},model:{value:e.field.stylePercent,callback:function(t){e.$set(e.field,"stylePercent",t)},expression:"field.stylePercent"}},e._l(e.widthOptions,function(t){return i("el-radio-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.value))])}))],1):e._e(),e._v(" "),e.canTransform&&e.transformData&&e.transformData[e.field.formType]?i("div",{staticClass:"item-section"},[i("div",{staticClass:"name"},[e._v("转化客户字段")]),e._v(" "),i("el-select",{attrs:{clearable:""},model:{value:e.field.relevant,callback:function(t){e.$set(e.field,"relevant",t)},expression:"field.relevant"}},e._l(e.transformData[e.field.formType],function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),e.canDescText?e._e():[i("div",{staticClass:"item-check-section"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0,disabled:!e.fieldAuth.nullEdit},model:{value:e.field.isNull,callback:function(t){e.$set(e.field,"isNull",t)},expression:"field.isNull"}},[e._v("设为必填")])],1),e._v(" "),e.canUnique?i("div",{staticClass:"item-check-section"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0,disabled:!e.fieldAuth.uniqueEdit},model:{value:e.field.isUnique,callback:function(t){e.$set(e.field,"isUnique",t)},expression:"field.isUnique"}},[e._v("设为唯一")])],1):e._e(),e._v(" "),e.showHidden?i("div",{staticClass:"item-check-section"},[i("el-checkbox",{attrs:{"true-label":1,"false-label":0,disabled:!e.fieldAuth.hiddenEdit},model:{value:e.field.isHidden,callback:function(t){e.$set(e.field,"isHidden",t)},expression:"field.isHidden"}},[e._v("隐藏字段")])],1):e._e()]],2)]):e._e()},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-tips"},[t("span",[this._v("*")]),this._v("标识名不能为空")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-tips"},[t("span",[this._v("*")]),this._v("显示在标识名右侧的说明文字")])}],!1,null,"59723c34",null));Ne.options.__file="index.vue";var Ae=Ne.exports,Ve=i("iCc5"),je=i.n(Ve),Oe=i("V7oC"),Ee=i.n(Oe),Pe=function(){function e(t){je()(this,e),this.fieldType=0,this.fieldId=t.fieldId||"",this.name=t.name||"",this.formType=t.formType||"",this.isUnique=t.isUnique||0,this.isNull=t.isNull||0,this.isHidden=t.isHidden||0,this.inputTips=t.inputTips||"","textarea"===this.formType&&(this.maxLength=t.maxLength||1e3),"checkbox"===this.formType?this.defaultValue=t.defaultValue||[]:this.defaultValue=t.defaultValue||"","form"===this.formType&&(this.formValue=t.formValue||[]),this.setting=t.setting||[],this.isDeleted=0}return Ee()(e,[{key:"check",value:function(){return""===this.name?"字段名称不能为空":""}}]),e}(),$e=i("ZoMv"),Se={name:"FieldsIndex",components:{FieldInput:_,FieldTextarea:x,FieldSelect:F,FieldCheckbox:N,FieldFile:j,FieldBoolean:P,FieldPercent:L,FieldPosition:I,FieldLocation:B,FieldDetailTable:H,FieldWritingSign:K,FieldDateInterval:G,FieldDescText:te,SettingField:Ae,draggable:fe.a},filters:{typeToComponentName:function(e){if(0===e.type)return"FieldInput";if(["text","number","floatnumber","mobile","email","date","datetime","user","structure","contacts","customer","contract","business","single_user","website"].includes(e.formType))return"FieldInput";switch(e.formType){case"textarea":return"FieldTextarea";case"select":return"FieldSelect";case"checkbox":return"FieldCheckbox";case"file":return"FieldFile";case"boolean_value":return"FieldBoolean";case"percent":return"FieldPercent";case"position":return"FieldPosition";case"location":return"FieldLocation";case"detail_table":return"FieldDetailTable";case"handwriting_sign":return"FieldWritingSign";case"date_interval":return"FieldDateInterval";case"desc_text":return"FieldDescText";default:return"FieldInput"}}},data:function(){return{moduleType:"",loading:!1,fieldLibList:[],dragLeftConfig:{delay:50,group:{pull:"clone",put:!1,name:"list"},forceFallback:!0,sort:!1},movedField:null,dragListConfig:{delay:50,group:"list",forceFallback:!0,fallbackClass:"draggingStyle"},fieldArr:[],rejectHandle:!0,selectedPoint:[null,null],selectedField:null,transformData:null}},computed:{canTransform:function(){return"crm_leads"==this.moduleType},canUnique:function(){return"oa_examine"!=this.moduleType},title:function(){return{crm_leads:"线索",crm_customer:"客户",crm_contacts:"联系人",crm_business:"商机",crm_contract:"合同",crm_product:"产品",crm_receivables:"回款",crm_visit:"客户回访",crm_marketing:"市场活动"}[this.moduleType]||""}},watch:{selectedField:{handler:function(){},deep:!0}},created:function(){this.moduleType=this.$route.params.type||"",this.initCom(),this.canTransform&&this.getTransformField()},methods:{initCom:function(){"crm_marketing"===this.moduleType?this.fieldLibList=we.filter(function(e){return["user","structure","file"].includes(e.formType)}):this.fieldLibList=we,this.getFieldList()},getFieldList:function(){var e=this;this.loading=!0;var t=null,i={},n=this.$route.params;"oa_examine"===this.moduleType?(t=o.u,i.categoryId=n.id):t=o.t,n.label&&(i.label=n.label),t(i).then(function(t){e.fieldArr=t.data||[],t.data.length>0&&e.handleSelect([0,0]),e.rejectHandle=!1,e.loading=!1}).catch(function(){e.loading=!1})},handleLibFieldClick:function(e){this.movedField=e,this.dragLeftEnd()},dragLeftMove:function(e){this.movedField=e},dragLeftEnd:function(e){if(!this.rejectHandle){var t=new Pe({name:this.movedField.name,formType:this.movedField.formType});t.stylePercent=100,t.operating=255,"desc_text"===this.movedField.formType&&(t.name="");var i=null;i=e&&e.newIndex?e.newIndex:this.selectedPoint[0]+1,this.fieldArr.splice(i,0,[t]),this.handleSelect([i,0])}},dragListEnd:function(e){this.selectedPoint.splice(0,1,e.newIndex)},handleAction:function(e,t){switch(e){case"top":this.handleActionMoveTop(t);break;case"bottom":this.handleActionMoveBottom(t);break;case"left":this.handleActionExchange(t,-1);break;case"right":this.handleActionExchange(t,1);break;case"copy":this.handleActionCopy(t);break;case"delete":this.handleDelete(t)}},handleActionMoveTop:function(e){var t=this.fieldArr[e[0]-1];if(t&&4!==t.length){var i=this.fieldArr[e[0]][e[1]];t.push(Object(ne.t)(i));var n=this.getWidth(t.length);t.forEach(function(e){e.stylePercent=n.stylePercent}),this.$set(this.fieldArr,e[0]-1,t);var l=this.fieldArr[e[0]];l.splice(e[1],1),0===l.length?this.fieldArr.splice(e[0],1):(n=this.getWidth(l.length),l.forEach(function(e){e.stylePercent=n.stylePercent}),this.$set(this.fieldArr,e[0],l)),this.handleSelect([e[0]-1,t.length-1])}},handleActionMoveBottom:function(e){var t=this.fieldArr[e[0]][e[1]];t.stylePercent=100,this.fieldArr.splice(e[0]+1,0,[t]),this.fieldArr[e[0]].splice(e[1],1);var i=this.fieldArr[e[0]],n=this.getWidth(i.length);i.forEach(function(e){e.stylePercent=n.stylePercent}),this.$set(this.fieldArr,e[0],i),this.handleSelect([e[0]+1,0])},handleActionExchange:function(e,t){var i=this.fieldArr[e[0]],n=this.fieldArr[e[0]][e[1]];i.splice(e[1],1),i.splice(e[1]+t,0,n),this.handleSelect([e[0],e[1]+t])},handleActionCopy:function(e){var t=this.fieldArr[e[0]][e[1]],i=Object(ne.t)(t);delete i.fieldId,delete i.fieldName,delete i.relevant,i.fieldType=0,i.operating=255,"desc_text"===i.formType&&(i.name=""),this.fieldArr.splice(e[0]+1,0,[i]),this.handleSelect([e[0]+1,e[1]])},handleUpdateFieldWidth:function(){for(var e=this.fieldArr[this.selectedPoint[0]],t=[],i=[],n=0,l=0;l<e.length;l++){var a=e[l];(n+=a.stylePercent)<100?i.push(a):n>100?(t.push(Object(ne.t)(i)),(i=[]).push(a),n=a.stylePercent):(i.push(a),t.push(Object(ne.t)(i)),i=[],n=0)}if(i.length>0&&t.push(i),t.length>1){var s,o=this.selectedPoint[0],r=this.selectedPoint[1];(s=this.fieldArr).splice.apply(s,[o,1].concat(t));for(var c=0,d=0;d<t.length;d++)if((c+=t[d].length)>=r+1){o+=d,r=r-c+t[d].length;break}this.handleSelect([o,r])}},getWidth:function(e){return 1===e?{stylePercent:100}:2===e?{stylePercent:50}:e>2?{stylePercent:25}:void 0},handleDelete:function(e){var t=this;this.$confirm("确定删除该自定义字段吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.fieldArr[e[0]].splice([e[1]],1),0===t.fieldArr[e[0]].length&&t.fieldArr.splice(e[0],1),t.$nextTick(function(){t.selectedPoint=[null,null],t.selectedField=null})}).catch(function(){})},handleSelect:function(e){this.selectedPoint=e,this.selectedField=this.fieldArr[e[0]][e[1]]},handleSave:function(){var e=this;if(!this.rejectHandle){var t=[];this.loading=!0,Object(ne.t)(this.fieldArr).forEach(function(e,i){e.forEach(function(e,n){t.push(s()({},e,{formPosition:i+","+n}))})});for(var i="select|update|union|and|or|delete|insert|trancate|char|substr|ascii|declare|exec|count|master|into|drop|execute".split("|"),n=[],a=function(l){var a=t[l],s=a.formPosition.split(","),o="第"+(Number(s[0])+1)+"行第"+(Number(s[1])+1)+"列";if(a.name=(a.name||"").trim(),"desc_text"!==a.formType){if(!a.name)return e.$message.error(o+"自定义字段，标识名不能为空"),e.loading=!1,{v:void 0};if(i.includes(a.name))return e.$message.error(o+"自定义字段标识名与系统字段重复，请使用其他字段！"),e.loading=!1,{v:void 0};if(n.includes(a.name))return e.$message.error(o+"自定义字段标识名重复"),e.loading=!1,{v:void 0};n.push(a.name)}else if(!Object(c.b)(a.defaultValue)&&a.defaultValue.length>2e3)return e.$message.error(o+"描述文字类型字段最多设置2000字"),e.loading=!1,{v:void 0};if(delete a.sysConfig,!a.type){var r=we.find(function(e){return e.formType===a.formType});r&&(a.type=r.type)}},r=0;r<t.length;r++){var d=a(r);if("object"===(void 0===d?"undefined":l()(d)))return d.v}var u={data:t},f=this.$route.params;"none"!==f.label&&(u.label=f.label),"oa_examine"===this.moduleType&&(u.categoryId=f.id),"crm_marketing"===this.moduleType&&(u.formId=f.id),({oa_examine:o.v}[this.moduleType]||o.r)(u).then(function(){e.$message({type:"success",message:"操作成功"}),e.loading=!1,e.getFieldList()}).catch(function(){e.loading=!1})}},getTransformField:function(){var e=this;Object(r.w)({label:$e.a.customer,type:1}).then(function(t){for(var i={text:[],textarea:[],select:[],checkbox:[],number:[],floatnumber:[],mobile:[],email:[],date:[],datetime:[],user:[],structure:[],boolean_value:[],percent:[],position:[],location:[],handwriting_sign:[],date_interval:[]},n=0;n<t.data.length;n++){var l=t.data[n],a=i[l.formType];a&&a.push({label:l.name,value:l.fieldId})}e.transformData=i}).catch(function(){})},handleCancel:function(){this.$router.go(-1)}}},Le=(i("CiQu"),Object(u.a)(Se,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fields-index body",attrs:{align:"flex-start",justify:"flex-start"}},[i("flexbox-item",{staticClass:"body-left"},[i("div",{staticClass:"body-left_title"},[e._v("字段库")]),e._v(" "),i("ul",[i("draggable",{staticClass:"lib-wrapper",attrs:{list:e.fieldLibList,options:e.dragLeftConfig,clone:e.dragLeftMove},on:{end:e.dragLeftEnd}},e._l(e.fieldLibList,function(t){return i("div",{key:t.id,staticClass:"lib-item",on:{click:function(i){e.handleLibFieldClick(t)}}},[i("i",{staticClass:"lib-item-icon",class:t.icon}),e._v(" "),i("span",[e._v(e._s(t.name))])])}))],1)]),e._v(" "),i("div",{staticClass:"body-content"},[i("flexbox",{staticClass:"body-content-warp",attrs:{align:"flex-start",justify:"flex-start",direction:"column"}},[i("el-header",[i("div",{staticClass:"title"},[e._v("编辑"+e._s(e.title)+"字段")]),e._v(" "),i("div",[i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleSave,expression:"handleSave"}],attrs:{type:"primary"}},[e._v("保存")]),e._v(" "),i("el-button",{on:{click:e.handleCancel}},[e._v("返回")])],1)]),e._v(" "),i("flexbox-item",{staticClass:"body-content-main",staticStyle:{"margin-left":"0"}},[i("el-main",[i("draggable",{staticClass:"field-list",attrs:{list:e.fieldArr,options:e.dragListConfig},on:{end:e.dragListEnd}},e._l(e.fieldArr,function(t,n){return i("flexbox",{key:n,staticClass:"field-row",attrs:{align:"flex-start",justify:"flex-start"}},e._l(t,function(t,l){return i(e._f("typeToComponentName")(t),{key:l,tag:"component",attrs:{field:t,"field-arr":e.fieldArr,point:[n,l],"active-point":e.selectedPoint},on:{action:e.handleAction,click:function(t){e.handleSelect([n,l])}}})}))}))],1)],1)],1)],1),e._v(" "),i("flexbox-item",{staticClass:"body-right",staticStyle:{"margin-left":"0"}},[e.selectedField?i("setting-field",{attrs:{field:e.selectedField,"can-transform":e.canTransform,"transform-data":e.transformData,"can-unique":e.canUnique},on:{"update-width":e.handleUpdateFieldWidth}}):e._e()],1)],1)},[],!1,null,"1c6ea7af",null));Le.options.__file="index.vue";t.default=Le.exports},"6bD/":function(e,t,i){},"6fR/":function(e,t,i){},"8iia":function(e,t,i){var n=i("QMMT"),l=i("RRc/");e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return l(this)}}},A8OQ:function(e,t,i){"use strict";var n=i("LcAW");i.n(n).a},B9jh:function(e,t,i){"use strict";var n=i("Wu5q"),l=i("n3ko");e.exports=i("raTm")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(l(this,"Set"),e=0===e?0:e,e)}},n)},C2SN:function(e,t,i){var n=i("93I4"),l=i("kAMH"),a=i("UWiX")("species");e.exports=function(e){var t;return l(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!l(t.prototype)||(t=void 0),n(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},CiQu:function(e,t,i){"use strict";var n=i("ixeW");i.n(n).a},CzaR:function(e,t,i){},DTtU:function(e,t,i){},Ef2B:function(e,t,i){},F35L:function(e,t,i){},K18i:function(e,t,i){},K8Hv:function(e,t,i){"use strict";var n=i("mjkN");i.n(n).a},KD76:function(e,t,i){"use strict";var n=i("sO83");i.n(n).a},LcAW:function(e,t,i){},NzIE:function(e,t,i){},OPQh:function(e,t,i){},Ozf1:function(e,t,i){"use strict";var n=i("u7C6");i.n(n).a},OzhN:function(e,t,i){"use strict";var n=i("CzaR");i.n(n).a},QCIG:function(e,t,i){"use strict";var n=i("F35L");i.n(n).a},QgEU:function(e,t,i){"use strict";var n=i("f6S/");i.n(n).a},"RRc/":function(e,t,i){var n=i("oioR");e.exports=function(e,t){var i=[];return n(e,!1,i.push,i,t),i}},"RU/L":function(e,t,i){i("Rqdy");var n=i("WEpk").Object;e.exports=function(e,t,i){return n.defineProperty(e,t,i)}},RjCt:function(e,t,i){"use strict";var n=i("jik7");i.n(n).a},Rqdy:function(e,t,i){var n=i("Y7ZC");n(n.S+n.F*!i("jmDH"),"Object",{defineProperty:i("2faE").f})},SEkw:function(e,t,i){e.exports={default:i("RU/L"),__esModule:!0}},"V+O7":function(e,t,i){i("aPfg")("Set")},V7Et:function(e,t,i){var n=i("2GTP"),l=i("M1xp"),a=i("JB68"),s=i("tEej"),o=i("v6xn");e.exports=function(e,t){var i=1==e,r=2==e,c=3==e,d=4==e,u=6==e,f=5==e||u,p=t||o;return function(t,o,h){for(var m,v,b=a(t),_=l(b),g=n(o,h,3),y=s(_.length),x=0,k=i?p(t,y):r?p(t,0):void 0;y>x;x++)if((f||x in _)&&(v=g(m=_[x],x,b),e))if(i)k[x]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return x;case 2:k.push(m)}else if(d)return!1;return u?-1:c||d?d:k}}},V7oC:function(e,t,i){"use strict";t.__esModule=!0;var n,l=i("SEkw"),a=(n=l)&&n.__esModule?n:{default:n};t.default=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,a.default)(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}()},Wu5q:function(e,t,i){"use strict";var n=i("2faE").f,l=i("oVml"),a=i("XJU/"),s=i("2GTP"),o=i("EXMj"),r=i("oioR"),c=i("MPFp"),d=i("UO39"),u=i("TJWN"),f=i("jmDH"),p=i("6/1s").fastKey,h=i("n3ko"),m=f?"_s":"size",v=function(e,t){var i,n=p(t);if("F"!==n)return e._i[n];for(i=e._f;i;i=i.n)if(i.k==t)return i};e.exports={getConstructor:function(e,t,i,c){var d=e(function(e,n){o(e,d,t,"_i"),e._t=t,e._i=l(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=n&&r(n,i,e[c],e)});return a(d.prototype,{clear:function(){for(var e=h(this,t),i=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var i=h(this,t),n=v(i,e);if(n){var l=n.n,a=n.p;delete i._i[n.i],n.r=!0,a&&(a.n=l),l&&(l.p=a),i._f==n&&(i._f=l),i._l==n&&(i._l=a),i[m]--}return!!n},forEach:function(e){h(this,t);for(var i,n=s(e,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(e){return!!v(h(this,t),e)}}),f&&n(d.prototype,"size",{get:function(){return h(this,t)[m]}}),d},def:function(e,t,i){var n,l,a=v(e,t);return a?a.v=i:(e._l=a={i:l=p(t,!0),k:t,v:i,p:n=e._l,n:void 0,r:!1},e._f||(e._f=a),n&&(n.n=a),e[m]++,"F"!==l&&(e._i[l]=a)),e},getEntry:v,setStrong:function(e,t,i){c(e,t,function(e,i){this._t=h(e,t),this._k=i,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?d(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,d(1))},i?"entries":"values",!i,!0),u(t)}}},YAll:function(e,t,i){},Z5jk:function(e,t,i){"use strict";var n=i("NzIE");i.n(n).a},aPfg:function(e,t,i){"use strict";var n=i("Y7ZC"),l=i("eaoh"),a=i("2GTP"),s=i("oioR");e.exports=function(e){n(n.S,e,{from:function(e){var t,i,n,o,r=arguments[1];return l(this),(t=void 0!==r)&&l(r),void 0==e?new this:(i=[],t?(n=0,o=a(r,arguments[2],2),s(e,!1,function(e){i.push(o(e,n++))})):s(e,!1,i.push,i),new this(i))}})}},bHGY:function(e,t,i){"use strict";var n=i("Ef2B");i.n(n).a},cHUd:function(e,t,i){"use strict";var n=i("Y7ZC");e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},dL40:function(e,t,i){var n=i("Y7ZC");n(n.P+n.R,"Set",{toJSON:i("8iia")("Set")})},dydj:function(e,t,i){"use strict";var n=i("2Kw3");i.n(n).a},"f6S/":function(e,t,i){},gLsL:function(e,t,i){"use strict";var n=i("ikOI");i.n(n).a},hFtp:function(e,t,i){},iCc5:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},ikOI:function(e,t,i){},ixeW:function(e,t,i){},jWXv:function(e,t,i){e.exports={default:i("+iuc"),__esModule:!0}},jik7:function(e,t,i){},kCQN:function(e,t,i){"use strict";var n=i("/Y58");i.n(n).a},kurV:function(e,t,i){"use strict";var n=i("DTtU");i.n(n).a},mjkN:function(e,t,i){},n3ko:function(e,t,i){var n=i("93I4");e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},nZ08:function(e,t,i){"use strict";var n=i("K18i");i.n(n).a},raTm:function(e,t,i){"use strict";var n=i("5T2Y"),l=i("Y7ZC"),a=i("6/1s"),s=i("KUxP"),o=i("NegM"),r=i("XJU/"),c=i("oioR"),d=i("EXMj"),u=i("93I4"),f=i("RfKB"),p=i("2faE").f,h=i("V7Et")(0),m=i("jmDH");e.exports=function(e,t,i,v,b,_){var g=n[e],y=g,x=b?"set":"add",k=y&&y.prototype,C={};return m&&"function"==typeof y&&(_||k.forEach&&!s(function(){(new y).entries().next()}))?(y=t(function(t,i){d(t,y,e,"_c"),t._c=new g,void 0!=i&&c(i,b,t[x],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in k&&(!_||"clear"!=e)&&o(y.prototype,e,function(i,n){if(d(this,y,e),!t&&_&&!u(i))return"get"==e&&void 0;var l=this._c[e](0===i?0:i,n);return t?this:l})}),_||p(y.prototype,"size",{get:function(){return this._c.size}})):(y=v.getConstructor(t,e,b,x),r(y.prototype,i),a.NEED=!0),f(y,e),C[e]=y,l(l.G+l.W+l.F,C),_||v.setStrong(y,e,b),y}},sO83:function(e,t,i){e.exports={xrColorPrimary:"#2362FB"}},u73G:function(e,t,i){"use strict";var n=i("hFtp");i.n(n).a},u7C6:function(e,t,i){},unMc:function(e,t,i){"use strict";var n=i("4R/5");i.n(n).a},v6xn:function(e,t,i){var n=i("C2SN");e.exports=function(e,t){return new(n(e))(t)}},xU3P:function(e,t,i){"use strict";var n=i("6fR/");i.n(n).a},xvv9:function(e,t,i){i("cHUd")("Set")},ydUZ:function(e,t,i){}}]);